/*! recat 2016-04-07 23:13:14 */
!function(){"use strict";angular.module("recatLibrary",[])}(),function(){"use strict";function a(a,b){function c(a,b,c,e,f,g){return d(a,b,c,e,f,g)}function d(b,c,d,g,h,i){var j={searchQuery:b};c&&(j.page=parseInt(c,10)),d&&(j.condition=d),g&&(j.sort=g),h&&(j.sortOrder=h),i.length&&(j.tid=i.join(","));var k=a({url:Drupal.settings.recatLibrary.serviceUrl,method:"GET",cache:!0,params:j});return k.then(e,f)}function e(a){return 200!==a.status?b.reject(a.statusText):a.data.success?a.data:b.reject(a.data.message)}function f(a){return angular.isObject(a.data)?b.reject(a.statusText):b.reject("An error occurred")}return{getFiles:c}}angular.module("recatLibrary").service("core.service.library",a),a.$inject=["$http","$q"]}(),function(){"use strict";function a(a,b,c,d){function e(){A.currentPage-=1,m()}function f(){A.currentPage+=1,m()}function g(a){A.currentPage=parseInt(a,10)-1,m()}function h(a,b){var c=!!a.target.checked;c?C.push(b):C=o(b),m()}function i(a){if(E===a)switch(F){case"asc":F="desc";break;case"desc":F="asc"}else E=a,F="asc";m()}function j(){m()}function k(a){if(t())return Drupal.behaviors.recatWfOverlay.openOverlayer(B.overlayUrl),void r();if(a.url)return a["private"]&&s()?void Drupal.behaviors.recatWfOverlay.openOverlayer(a.url):void(document.location=a.url)}function l(){r(!0),setTimeout(r,100)}function m(){r(!0),A.loading=!0,d.getFiles(A.searchQuery,A.currentPage,D,E,F,C).then(p,q)}function n(){var a=[],b=Math.ceil(z/2),c=A.currentPage+1,d=c-b+1,e=c+z-b,f=A.totalPages,g=d;for(e>f&&(g+=f-e,e=f),0>=g&&(e+=1-g,g=1),g>1&&a.push("ellipsis");e>=g&&f>=g;g+=1)a.push(g);return f>g&&a.push("ellipsis"),a}function o(a){for(var b=[],c=0,d=C.length;d>c;c+=1)a!==C[c]&&b.push(C[c]);return b}function p(a){A.loaded=!0,A.loading=!1,A.nodes=a.nodes,A.currentPage=a.pager.current,A.totalPages=a.pager.pages,A.pages=n(),w(),setTimeout(r,100)}function q(a){A.loaded=!0,A.loading=!1,A.nodes=A.pages=[],A.currentPage=A.totalPages=0,A.errorMessage=a.text}function r(a){return s()?a?void Drupal.behaviors.recatWfOverlay.detach(b):void Drupal.behaviors.recatWfOverlay.attach(b):void 0}function s(){return Drupal&&Drupal.behaviors&&Drupal.behaviors.recatWfOverlay}function t(){return s()?(console.log(B.cookieName),console.log(x(B.cookieName)),!x(B.cookieName)):!1}function u(a){return E===a}function v(a){return"desc"===F&&u(a)}function w(){return G?void(G=!1):void jQuery("html, body").animate({scrollTop:b.offset().top},400)}function x(a){var b="; "+document.cookie,c=b.split("; "+a+"=");return 2===c.length?c.pop().split(";").shift():void 0}function y(a){return a&&Drupal.settings[a]?angular.extend(Drupal.settings[a],Drupal.settings.recatLibrary):Drupal.settings.recatLibrary}var z=9,A=this,B=y(c.instance),C=[],D=B.condition,E="",F="",G=!0;if(A.loaded=!1,A.loading=!0,A.currentPage=0,A.totalPages=0,A.pages=[],A.nodes=[],A.searchQuery="",A.errorMessage="",A.pagePrevious=e,A.pageNext=f,A.pageChange=g,A.filterChange=h,A.sortingChange=i,A.queryChange=j,A.downloadFile=k,A.requestFile=l,A.isSortingActive=u,A.isSortingOrderDesc=v,A.isFirstDownloadRequest=t(),A.firstDownloadRequestUrl=B.overlayUrl,B.tid)for(var H=B.tid.split(","),I=0,J=H.length;J>I;I+=1)C.push(H[I]);m()}angular.module("recatLibrary").controller("ListingController",a),a.$inject=["$scope","$element","$attrs","core.service.library"]}();